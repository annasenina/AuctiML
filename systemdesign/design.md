# AuctiML
## Проект по оценке лотов на торгах

## 1. Цели и предпосылки

### 1.1. Зачем идем в разработку продукта?
Бизнес-цель Product Owner
Научиться предсказывать результаты торгов по земельным участкам с сайта, которые выкладывают на сайт https://torgi.gov.ru/new/public/lots/reg 
Можем предсказывать результаты торгов: состоялись, не состоялись. 
Или предсказывать финальную цену, за которую уйдет лот.

## Почему станет лучше, чем сейчас, от использования ML?
Сейчас пользователь должен вручную смотреть результаты прошлых торгов и руками анализировать, заявится ли кто-то на них, до какой цены доходили другие лоты. И в результате анализа принимать решение: заявляться на этот лот или нет. 

У нас несколько целевых сегментов: 
Земельные специалисты - ищут участки для клиентов: индивидуалов, застройщиков, инвесторов.
Застройщики - ищут участки для застройки и перепродажи участков с домом
Индивидуалы - ищут участок, чтобы построить себе дом
Инвесторы - ищут участки для вложения денег с целью заработать на них

Подробнее о пользователях сервисом можно почитать в [Потребительские сегменты](users.md)

Наша система будет предсказывать результат торгов для новых лотов, которые только выставили на торги. Пользователь может использовать данные для принятия решения: участвовать или нет в торгах по этому лоту, а не анализировать каждый лот вручную. 

## Что считаем успешным пилотом? Критерии успеха и возможные пути развития проекта Product Owner
Проект будет считаться успешным при соблюдении следующих условий:
 - Уровень ошибки в предсказании финальная цены лота (MAPE/MDAPE) не превышает - 5-10%
 - Уровень ошибки в предсказании состоялись торги или нет - не превышает - 15%
 - Интерпретируемость является достаточной и полной для принятия решения об участии в торгах

Дополнительным условием успешности проекта является нахождением заинтересованных лиц (инвесторов) в дальнейшем развитии проекта.

## 2. Методология
### 2.1. Постановка задачи

Основная задача проекта разработать модель предсказывающую итоговую цену, за которую может быть взят в аренду земельный участок.  
 
Признаковое пространство:  
   - Информация о земельном участке, общие характеристики (площадь, месторасположение), другие базовые признаки, доступные из описания объекта торгов.
   - Сгенерированные ГЕО признаки (например, удаленность от ЖД, ближайшие города).
   - Статистика по району (например, плотность населения, средний возраст).
   - Сгенерированные признаки - производные признаки рассчитанные на базе других признаков.

Целевая функция: итоговая цена аренды земельного участка, на момент завершения торгов  

Дополнительные задачи проекта:  
   1. Определить вероятность того, что торги состояться (задача классификации)  
   2. Предсказать итоговую цену аренды земельного участка по завершению торгов (задача регрессии)


### 2.2. Блок-схема решения
![baseline_block_image2.png](media/baseline_block_image2.png)
[Архитектура бота](bot.md) 

### 2.3. Этапы решения задачи
   - Этап 1 - Подготовка данных.
   - Этап 2 - Подготовка прогнозных моделей
   - Этап 3 - Интерпретация моделей (согл. с заказчиком)
   - Этап 4 - Интеграция бизнес правил для расчета бизнес-метрик качества модели
   - Этап 5 - Подготовка инференса модели по итерациям
   - Этап 6 - Интеграция бизнес правил
   - Этап 7 - Разработка оптимизатора (выбор оптимальной итерации)
   - Этап 8 - Подготовка финального отчета для бизнеса
   
## 3. Подготовка пилота
### 3.1. Способ оценки пилота
Пилотный проект решения (MVP) будет представлять чат-бот. Пользователь направляет в чат-бот ссылку на объект торгов с сайта [https://torgi.gov.ru](https://torgi.gov.ru).   
В ответ пользователю сообщается:
 - предсказанние состоятся торги или нет
 - стоимость аренды земельного участка, до которой дойдут торги
 
### 3.2. Домен данных
Датасет представляет собой табличные данные о земельных участках.
Базовые признаки объекта:
 - Вид разрешенного использования
 - Кадастровый номер
 - Адрес
 - Площадь
 - Краткое описание лота
 - Подробное описание лота
 - Договор аренды
 - Дата публикации
 - Дата окончания подачи заявки
 - Дата торгов
 - Стартовая цена
 - Шаг аукциона
 - Комиссия организатора
 - Результат торгов: состоялся/не состоялся/аннулирован
 - Организатор торгов
 - Очные/электронные
 - Есть связанные лоты
 - Администрация (и все контакты?)
 - Возможность заключения договора со вторым участником
 - Время ожидания нового ценового предложения
 
В качестве целевой функции будет использоваться “финальная цена лота”.
  
Помимо базовых признаков также будет использоваться дополнительные данные из внешних источников: геопризнаки (например, удаленность от ЖД, ближайшие города), статистика по районам (например, плотность населения, средний возраст). Также будет выполнена генерация дополнительных признаков -  производные признаки рассчитанные на базе других признаков.
  
Признаковое пространство будет содержать числовые и категориальные признаки. Категориальные признаки будут обрабатываться для представления в числовом виде.   

Данные о лоте будем брать из метода API портала https://torgi.gov.ru/ 
Подробнее о структуре данных в разделе [данные для обучения](data.md)

### 3.2. Выбор архитектуры решения
При построении моделей будут использоваться бустинг деревья. Данный выбор обусловлен следующими соображениями:    
1. При работе с табличными данными деревья демонстрируют лучшие показатели чем нейронные сети и линейные модели.
2. Категориальные признаки будут обрабатываться внутренними механизмами CatBoost, что позволит уменьшить время разработки и позволит исключить возможные ошибки.
3. При использовании деревьев нормализацию признаков не требуется производить, что позволит уменьшить время разработки и позволит исключить возможные ошибки.


### 3.3. Что считаем успешным пилотом
Успешность пилота определяется по следующим критериям:
1. Точность работы модели
2. Интерпретируемость ответа решения

Достижение заданных метрик определяется отдельно для каждого вида генерируемой информации:    
1. Предсказанная цена лота на торгах. Метрика модели MAE и MAPE между предсказанной ценой и реальной ценой лота на торгах. 
2. Состоялись торги или нет. Будет оцениваться через ROC AUC, который рассчитаем на выборке объектов с сайта торгов 
3. Интерпретируемость рекомендаций по объекту будут оцениваться экспертным путем.

Оценка экспертным путем подразумевает участие представителей команды и внешних привлеченных экспертов.  

Проект будет считаться успешным при соблюдении следующих условий:
1. Уровень ошибки в предсказании цены лота на торгах (MAPE/MDAPE) не превышает - 5-10% 
2. Верно предсказан результат торгов: состоятся/не состоятся. Модель при threshold = 0.8 успешно определяет результат торгов не меньше чем в 85% случаях.
3. Интерпретируемость является достаточной и полной для принятия решения об участии в торгах на этот лот.  

Дополнительным условием успешности проекта является нахождением заинтересованных лиц (инвесторов) в дальнейшем развитии проекта.


### 3.3. Подготовка пилота
В качестве целевых моделей планируется использовать бустинг деревьев. Использование GPU в проекте не планируется. Все расчеты планируется выполнять на локальных компьютерах участников команды.
  
Наибольшие вычислительные затраты будут в процессе генерации сложных признаков. В случае превышения доступных вычислительных лимитов будет выполнятся пересмотр алгоритм по генерации признаков, отказ от ряда “дорогих” по вычислительным затратам признаков, поиск дополнительных мощностей.
  
Вычислительная сложность модели закладывается как минимальная.

## 4. Внедрение для production систем, если требуется
### 4.1. Архитектура решения
![arch](media/main_image1.png)

### 4.2. Описание инфраструктуры и масштабируемости
Необходим сервер для размещения бота и апи для работы с пользователями. 
Выбор инфраструктуры внедрения MVP будет определен на последующих этапах.
### 4.3. Требования к работе системы
Необходимо выдержать одновременную нагрузку 100 пользователей
### 4.4. Издержки
Стоимость аренды сервера для размещения бота и апи для работы с пользователями. 
### 4.5. Integration points
Метод api - /predict вызывается из AuctiML бота, когда в бота приходит запрос от пользователя

### 4.6. Риски
Недостаточно данных для обучения модели необходимого качества
Бот может не выдержать необходимой нагрузки

  

  


